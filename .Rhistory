,q25 = quantile(col,na.rm = T, .25)
,q75 = quantile(col,na.rm = T, .75))
data %>% group_by(group) %>%
summarise_all(
,mean = mean(na.rm = T)
,sd = sd(na.rm = T)
,median = median(col,na.rm = T)
,min = min(col,na.rm = T)
,max = max(col,na.rm = T)
,q25 = quantile(col,na.rm = T, .25)
,q75 = quantile(col,na.rm = T, .75))
data %>% group_by(group) %>%
summarise_all(
mean = mean(na.rm = T)
,sd = sd(na.rm = T)
,median = median(col,na.rm = T)
,min = min(col,na.rm = T)
,max = max(col,na.rm = T)
,q25 = quantile(col,na.rm = T, .25)
,q75 = quantile(col,na.rm = T, .75))
data %>% group_by(group=="Control") %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
data %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
data[group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75)) %>% group_vars()
data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
names(df)[1]<-"age"
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
names(df)[1]<-"age"
df
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
df[1,]<-"age"
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
df[1,]<-factor("age")
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
df[,-1]<-"age"
df
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind("age",df)
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(age, na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(as.name("age"), na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(assign("age"), na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(assign("age",0), na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(., na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(., na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise(n = n()
,mean = mean(~., na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise(n = n()
,mean = mean((.), na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise(n = n()
,mean = mean((1), na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
stat(0)
install.packages("psych")
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data, data$group)
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data[,c(29,30,32:37,39, 58)], data$group)
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data[,c(29,30,32:37,39, 58)], data$group, na.rm = T)
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[,1]
library(psych)
stat <- function (col){
df<-data[data$group=="Control",c("age","group")] %>% group_by(group) %>%
summarise_each(n = n()
,mean = mean( na.rm = T)
,sd = sd(age, na.rm = T)
,median = median(age, na.rm = T)
,min = min(age, na.rm = T)
,max = max(age, na.rm = T)
,q25 = quantile(age, na.rm = T, .25)
,q75 = quantile(age, na.rm = T, .75))
cbind(var = "age",df)
}
#stat(0)
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[,1,1]
dim(describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T))
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[1]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[1][,c(-1)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[[1]]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[[1]][,c(-1)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[[1]][,c(2:5,8,9))]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)[[1]][,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Control[,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Control[,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Rational[,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Emotional[,c(2:5,8,9)]
describeBy(data[,c(32:37,39,54:62)], data$group, na.rm = T)$Control[,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Rational[,c(2:5,8,9)]
describeBy(data[,c(32:37,39, 58)], data$group, na.rm = T)$Emotional[,c(2:5,8,9)]
#models  RB
emo_all<-data[!is.na(data$emo),]
emo_all<-na.omit(emo_all[,c(29,32:35,45:58)])
emo_all$month <- factor(emo_all$month)
dummy <- dummyVars( ~ month, data = emo_all)
unlink('_report_cache', recursive = TRUE)
dplot <- function (d, s, o, t){
plot(density(d[,s], bw = 0.15), type = "l", col = "1", lwd = 1, bty="n", main = "",#main = paste(s,t),
yaxt="n", ylim=c(0,2.5), xaxt="n")
axis(side=1,at=c(0.0,0.5,1.0))
lines(density(d[,o], bw = 0.15), lty = 2, lwd = 1, col = "2")
#legend("topright",legend = c("self", "other"),
#       col = c("1","2"), lwd = c(1,1),
#       lty = c(1,2), bty = "n")
print(paste0(s," ", o, " ", t))
#t.test(d[,s], d[,o], paired = TRUE, alternative = "two.sided") #Критерий Стьюдента
w<-wilcox.test(d[,s], d[,o], paired = TRUE, alternative = "greater") #Критерий Уилкоксона
legend("topright",legend = c(s, t, ifelse(w$p.value<0.01,"p < 0.01", "p > 0.1")), bty = "n")
w
}
#RB
cols <- c(56:59,61:64)
par(mfrow = c(4,4), mar=c(1.8,1.1,1.5,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"RB","RBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"RB","RBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"RB","RBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"RB","RBo","Emotional")
#ESB
#par(mfrow = c(4,4), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"ESB","ESBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"ESB","ESBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"ESB","ESBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"ESB","ESBo","Emotional")
#RSB
#par(mfrow = c(2,2), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"RSB","RSBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"RSB","RSBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"RSB","RSBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"RSB","RSBo","Emotional")
#EMB
#par(mfrow = c(2,2), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"EMB","EMBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"EMB","EMBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"EMB","EMBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"EMB","EMBo","Emotional")
dplot <- function (d, s, o, t){
plot(density(d[,s], bw = 0.15), type = "l", col = "1", lwd = 1, bty="n", main = "",#main = paste(s,t),
yaxt="n", ylim=c(0,2.5), xaxt="n")
axis(side=1,at=c(0.0,0.5,1.0))
lines(density(d[,o], bw = 0.15), lty = 2, lwd = 1, col = "2")
#legend("topright",legend = c("self", "other"),
#       col = c("1","2"), lwd = c(1,1),
#       lty = c(1,2), bty = "n")
#print(paste0(s," ", o, " ", t)) #print label for wilcox data
#t.test(d[,s], d[,o], paired = TRUE, alternative = "two.sided") #Критерий Стьюдента
w<-wilcox.test(d[,s], d[,o], paired = TRUE, alternative = "greater") #Критерий Уилкоксона
legend("topright",legend = c(s, t, ifelse(w$p.value<0.01,"p < 0.01", "p > 0.1")), bty = "n")
#w # print wilcox output
}
#RB
cols <- c(56:59,61:64)
par(mfrow = c(4,4), mar=c(1.8,1.1,1.5,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"RB","RBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"RB","RBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"RB","RBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"RB","RBo","Emotional")
#ESB
#par(mfrow = c(4,4), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"ESB","ESBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"ESB","ESBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"ESB","ESBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"ESB","ESBo","Emotional")
#RSB
#par(mfrow = c(2,2), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"RSB","RSBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"RSB","RSBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"RSB","RSBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"RSB","RSBo","Emotional")
#EMB
#par(mfrow = c(2,2), mar=c(2,2,2,1))
d<-na.omit(rat_data[rat_data$rat==0,cols])
dplot(d,"EMB","EMBo","Control")
d<-na.omit(rat_data[rat_data$rat==1,cols])
dplot(d,"EMB","EMBo","Rational")
d<-na.omit(emo_data[emo_data$emo==0,cols])
dplot(d,"EMB","EMBo","Control")
d<-na.omit(emo_data[emo_data$emo==1,cols])
dplot(d,"EMB","EMBo","Emotional")
View(df)
View(rat_data)
View(rat_all)
unlink('_report_cache', recursive = TRUE)
